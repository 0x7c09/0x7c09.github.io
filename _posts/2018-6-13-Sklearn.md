---
title: Sklearn
categories: Assignment
date: 2018-06-13 31:59:13 +0800
published: true

---
# Sklearn
## step 1
> crreate a classification dataset(n_samples >= 1000, n_features >= 10)

``` python
dataset = datasets.make_classification(n_samples=1000, n_features=10, n_informative = 8, n_redundant=2, n_repeated=0, n_classes=4)
```

## step 2

> split the dataset using 10-fold cross validation

``` python
kf = cross_validation.KFold(
    len(dataset[0]), 
    n_folds=10, 
    shuffle=True)
for train_index, test_index in kf:
    X_train, y_train = dataset[0][train_index], dataset[1][train_index]
    X_test, y_test = dataset[0][test_index], dataset[1][test_index]
```
## step 3
### GaussianNB
``` python
from sklearn.naive_bayes import GaussianNB
for train_index, test_index in kf:
    X_train, y_train = dataset[0][train_index], dataset[1][train_index]
    X_test, y_test = dataset[0][test_index], dataset[1][test_index]

    clf = GaussianNB()
    clf.fit(X_train, y_train)
    pred = cli.predict(X_test)
```
### SVC
> possible C value [1e-02, 1e-01, 1e00, 1e01, 1e02], RBF kernel
``` python
from sklearn.svm import SVC
params = [1e-02, 1e-01, 1e00, 1e01, 1e02]
for train_index, test_index in kf:
    X_train, y_train = dataset[0][train_index], dataset[1][train_index]
    X_test, y_test = dataset[0][test_index], dataset[1][test_index]

    for c in params:
        clf = SVC(C=c, kernel='rbf', gamma=0.1)
        clf.fit(X_train, y_train)
        pred = clf.predict(X_test)
```
### RandomForestClassifer
> possible n estimators values[10, 100, 1000]
``` python
from sklearn.ensemble import RandomForestClassifier

params = [10, 100, 1000]
for train_index, test_index in kf:
    X_train, y_train = dataset[0][train_index], dataset[1][train_index]
    X_test, y_test = dataset[0][test_index], dataset[1][test_index]

    for estimate in params:
        clf = RandomForestClassifier(n_estimators = estimate)
        clf.fit(X_train, y_train)
        pred = clf.predict(X_test)
```
## Evaluate the cross-validated performance
### Accuracy
``` python
from sklearn import metrics
acc = metrics.accuracy_score(y_test, pred)
```
### F1-score
``` python
from sklearn import metrics
f1 = metrics.f1_score(y_test, pred)
```
### AUC ROC
``` python
from sklearn import metrics
auc = metrics.roc_auc_score(y_test, pred)
```
